2025-04-26 19:54:20,537 - INFO - APIServer - Starting Uvicorn server on 0.0.0.0:8000
2025-04-26 19:54:20,586 - INFO - APIServer - Server starting up...
2025-04-26 19:54:20,587 - INFO - APIServer - Attempting to load model from: ./results/BEST_atis_multilabel_xlmr_lora
2025-04-26 19:54:20,587 - ERROR - APIServer - Failed to load model during startup: name 'torch' is not defined
Traceback (most recent call last):
  File "/workspaces/zendesk-mle/coding_task/server/server.py", line 61, in startup_event
    device=os.environ.get("INFERENCE_DEVICE", "cuda" if torch.cuda.is_available() else "cpu"),
                                                        ^^^^^
NameError: name 'torch' is not defined
2025-04-26 19:55:10,322 - INFO - APIServer - Starting Uvicorn server on 0.0.0.0:8000
2025-04-26 19:55:10,356 - INFO - APIServer - Server starting up...
2025-04-26 19:55:10,356 - INFO - APIServer - Attempting to load model from: ./results/BEST_atis_multilabel_xlmr_lora
2025-04-26 19:55:10,357 - INFO - InferencePredictor - Using device: cpu
2025-04-26 19:55:10,357 - INFO - InferencePredictor - Loading resources from: ./results/BEST_atis_multilabel_xlmr_lora
2025-04-26 19:55:10,973 - INFO - InferencePredictor - Tokenizer loaded successfully.
2025-04-26 19:55:10,974 - INFO - InferencePredictor - Using tokenizer's max_seq_length: 512
2025-04-26 19:55:10,975 - INFO - InferencePredictor - Inferred base model from PEFT config: xlm-roberta-base
2025-04-26 19:55:10,978 - INFO - InferencePredictor - Loaded model config. Task type: multilabel, Num Labels: 17
2025-04-26 19:55:10,978 - INFO - InferencePredictor - Loading base model: xlm-roberta-base
2025-04-26 19:55:18,352 - INFO - InferencePredictor - Loading PEFT adapter weights from: ./results/BEST_atis_multilabel_xlmr_lora
2025-04-26 19:55:19,107 - INFO - InferencePredictor - PEFT adapter loaded and merged successfully.
2025-04-26 19:55:19,109 - INFO - InferencePredictor - Model moved to cpu and set to evaluation mode.
2025-04-26 19:55:19,109 - INFO - APIServer - Model loaded successfully. Server is ready.
2025-04-26 19:56:16,308 - INFO - APIServer - Starting Uvicorn server on 0.0.0.0:8000
2025-04-26 19:56:16,351 - INFO - APIServer - Server starting up...
2025-04-26 19:56:16,352 - INFO - APIServer - Attempting to load model from: ./results/BEST_atis_multilabel_xlmr_lora
2025-04-26 19:56:16,352 - INFO - InferencePredictor - Using device: cpu
2025-04-26 19:56:16,352 - INFO - InferencePredictor - Loading resources from: ./results/BEST_atis_multilabel_xlmr_lora
2025-04-26 19:56:16,987 - INFO - InferencePredictor - Tokenizer loaded successfully.
2025-04-26 19:56:16,987 - INFO - InferencePredictor - Using tokenizer's max_seq_length: 512
2025-04-26 19:56:16,988 - INFO - InferencePredictor - Inferred base model from PEFT config: xlm-roberta-base
2025-04-26 19:56:16,992 - INFO - InferencePredictor - Loaded model config. Task type: multilabel, Num Labels: 17
2025-04-26 19:56:16,993 - INFO - InferencePredictor - Loading base model: xlm-roberta-base
2025-04-26 19:56:23,884 - INFO - InferencePredictor - Loading PEFT adapter weights from: ./results/BEST_atis_multilabel_xlmr_lora
2025-04-26 19:56:24,490 - INFO - InferencePredictor - PEFT adapter loaded and merged successfully.
2025-04-26 19:56:24,492 - INFO - InferencePredictor - Model moved to cpu and set to evaluation mode.
2025-04-26 19:56:24,493 - INFO - APIServer - Model loaded successfully. Server is ready.
2025-04-26 19:58:47,204 - INFO - APIServer - Received intent request for text: 'find me a flight that flies from Memphis to tacoma...'
2025-04-26 19:58:47,204 - INFO - InferencePredictor - Starting prediction for 1 text(s)...
2025-04-26 19:58:49,251 - INFO - InferencePredictor - Prediction finished.
2025-04-26 19:58:49,252 - INFO - APIServer - Prediction successful. Top intent: flight
2025-04-26 19:59:33,588 - WARNING - APIServer - Received request with empty text.
2025-04-26 20:00:04,611 - INFO - APIServer - Received intent request for text: '@!!...'
2025-04-26 20:00:04,611 - INFO - InferencePredictor - Starting prediction for 1 text(s)...
2025-04-26 20:00:04,660 - INFO - InferencePredictor - Prediction finished.
2025-04-26 20:00:04,661 - INFO - APIServer - Prediction successful. Top intent: abbreviation
2025-04-26 20:00:14,070 - INFO - APIServer - Received intent request for text: 'find me a flight that flies from Memphis to tacoma...'
2025-04-26 20:00:14,070 - INFO - InferencePredictor - Starting prediction for 1 text(s)...
2025-04-26 20:00:14,145 - INFO - InferencePredictor - Prediction finished.
2025-04-26 20:00:14,145 - INFO - APIServer - Prediction successful. Top intent: flight
2025-04-26 20:14:10,699 - INFO - APIServer - Starting Uvicorn server on 0.0.0.0:8000
2025-04-26 20:14:30,829 - INFO - APIServer - Starting Uvicorn server on 0.0.0.0:8000
2025-04-26 20:15:44,839 - INFO - APIServer - Starting Uvicorn server on 0.0.0.0:8000
2025-04-26 20:18:06,914 - INFO - APIServer - Server starting up...
2025-04-26 20:18:06,914 - INFO - APIServer - Attempting to load model from: /workspaces/zendesk-mle/coding_task/results/BEST_atis_multilabel_xlmr_lora
2025-04-26 20:18:06,915 - INFO - InferencePredictor - Using device: cpu
2025-04-26 20:18:06,915 - INFO - InferencePredictor - Loading resources from: /workspaces/zendesk-mle/coding_task/results/BEST_atis_multilabel_xlmr_lora
2025-04-26 20:18:06,915 - ERROR - InferencePredictor - Model path not found or is not a directory: /workspaces/zendesk-mle/coding_task/results/BEST_atis_multilabel_xlmr_lora
2025-04-26 20:18:06,915 - ERROR - APIServer - Failed to load model during startup: Model path not found: /workspaces/zendesk-mle/coding_task/results/BEST_atis_multilabel_xlmr_lora
Traceback (most recent call last):
  File "/workspaces/zendesk-mle/coding_task/server/server.py", line 64, in lifespan
    app_state["predictor"] = TextClassifierPredictor(inference_config)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/zendesk-mle/coding_task/inference/predictor.py", line 39, in __init__
    self._load_resources()
  File "/workspaces/zendesk-mle/coding_task/inference/predictor.py", line 48, in _load_resources
    raise FileNotFoundError(f"Model path not found: {model_path}")
FileNotFoundError: Model path not found: /workspaces/zendesk-mle/coding_task/results/BEST_atis_multilabel_xlmr_lora
2025-04-26 20:24:39,732 - INFO - APIServer - Server shutting down...
2025-04-26 20:41:14,631 - INFO - APIServer - Starting Uvicorn server on 0.0.0.0:8000
2025-04-26 20:41:21,217 - INFO - APIServer - Server starting up...
2025-04-26 20:41:21,217 - INFO - APIServer - Attempting to load model from: results/BEST_atis_multilabel_xlmr_lora
2025-04-26 20:41:21,218 - INFO - InferencePredictor - Using device: cpu
2025-04-26 20:41:21,218 - INFO - InferencePredictor - Loading resources from: results/BEST_atis_multilabel_xlmr_lora
2025-04-26 20:41:22,265 - INFO - InferencePredictor - Tokenizer loaded successfully.
2025-04-26 20:41:22,266 - INFO - InferencePredictor - Using tokenizer's max_seq_length: 512
2025-04-26 20:41:22,268 - INFO - InferencePredictor - Inferred base model from PEFT config: xlm-roberta-base
2025-04-26 20:41:22,271 - INFO - InferencePredictor - Loaded model config. Task type: multilabel, Num Labels: 17
2025-04-26 20:41:22,271 - INFO - InferencePredictor - Loading base model: xlm-roberta-base
2025-04-26 20:41:34,049 - INFO - InferencePredictor - Loading PEFT adapter weights from: results/BEST_atis_multilabel_xlmr_lora
2025-04-26 20:41:35,543 - INFO - InferencePredictor - PEFT adapter loaded and merged successfully.
2025-04-26 20:41:35,548 - INFO - InferencePredictor - Model moved to cpu and set to evaluation mode.
2025-04-26 20:41:35,549 - INFO - APIServer - Model loaded successfully using device: cpu. Server is ready.
2025-04-26 20:41:54,157 - INFO - APIServer - Received intent request for text: 'find me a flight that flies from Memphis to tacoma...'
2025-04-26 20:41:54,158 - INFO - InferencePredictor - Starting prediction for 1 text(s)...
2025-04-26 20:41:56,998 - INFO - InferencePredictor - Prediction finished.
2025-04-26 20:41:56,998 - INFO - APIServer - Prediction successful. Top intent: flight
2025-04-26 20:42:09,275 - INFO - APIServer - Received intent request for text: 'find me a airline that flies from Memphis to tacoma...'
2025-04-26 20:42:09,276 - INFO - InferencePredictor - Starting prediction for 1 text(s)...
2025-04-26 20:42:09,476 - INFO - InferencePredictor - Prediction finished.
2025-04-26 20:42:09,477 - INFO - APIServer - Prediction successful. Top intent: airline
2025-04-26 20:43:16,312 - INFO - APIServer - Received intent request for text: 'find me a airline that flies from Memphis to tacoma...'
2025-04-26 20:43:16,314 - INFO - InferencePredictor - Starting prediction for 1 text(s)...
2025-04-26 20:43:16,772 - INFO - InferencePredictor - Prediction finished.
2025-04-26 20:43:16,772 - INFO - APIServer - Prediction successful. Top intent: airline
2025-04-26 20:43:23,923 - INFO - APIServer - Received intent request for text: 'find me a akshay that flies from Memphis to tacoma...'
2025-04-26 20:43:23,923 - INFO - InferencePredictor - Starting prediction for 1 text(s)...
2025-04-26 20:43:24,024 - INFO - InferencePredictor - Prediction finished.
2025-04-26 20:43:24,024 - INFO - APIServer - Prediction successful. Top intent: flight
